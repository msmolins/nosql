<html>
<head>
  <script type='text/javascript' src='http://www.google.com/jsapi'></script>
  <script type='text/javascript'>
    google.load("jquery", "1.4.2");
    google.load('visualization', '1', {'packages': ['geomap']});
 
    google.setOnLoadCallback(init_map);
 
    function init_map(){
      $.ajax({
        url: 'country_list_json',
        success: drawMap
      });      
    }
 
    function drawMap(incomingdata) {
      json_data = eval(incomingdata);
      var data = new google.visualization.DataTable();
 
      data.addRows(json_data.length);
      data.addColumn('string', 'Country');
      data.addColumn('number', 'Ilosc programow telewizyjnych');
      data.addColumn('string','HOVER', 'Details');
      for(i=0;i<json_data.length;i++){
        data.setValue(i, 0, json_data[i]['country_name']);
        data.setValue(i, 1, parseInt(json_data[i]['total']));
        data.setValue(i, 2, json_data[i]['country_name']);
      }
 
 
      var options = {};
      options['dataMode'] = 'regions';
      //options['width'] = '605px';
      //options['height'] = '362px';
      options['colors'] = [0xcd3700,0xffe4db,0xcd370a,0xffe4d5,0xcd3730,0xffe4d5,0xcd3702,0xf3e4da,0xcd5700,0xffe3da,0xcd3707,0xcd3a07];
 
      var container = document.getElementById('map_canvas');
      var geomap = new google.visualization.GeoMap(container);
 
			google.visualization.events.addListener(
	      geomap, 'regionClick', function(e) {
	      //alert(e['region']);
	      window.open ("http://www.ethnologue.com/show_country.asp?name="+e['region']); 
	    }); 
 
      geomap.draw(data, options);
  };
  </script>
</head>
 
<body>
  <div id='map_canvas'></div>
</body>
</html>